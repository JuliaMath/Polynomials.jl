<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Extensions · Polynomials.jl</title><meta name="title" content="Extensions · Polynomials.jl"/><meta property="og:title" content="Extensions · Polynomials.jl"/><meta property="twitter:title" content="Extensions · Polynomials.jl"/><meta name="description" content="Documentation for Polynomials.jl."/><meta property="og:description" content="Documentation for Polynomials.jl."/><meta property="twitter:description" content="Documentation for Polynomials.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="Polynomials.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Polynomials.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../reference/">Reference/API</a></li><li><span class="tocitem">Polynomial Types</span><ul><li><a class="tocitem" href="../polynomials/polynomial/">Polynomial</a></li><li><a class="tocitem" href="../polynomials/chebyshev/">Chebyshev</a></li></ul></li><li><a class="tocitem" href="../extending/">Extending</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Extensions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Extensions</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaMath/Polynomials.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaMath/Polynomials.jl/blob/master/docs/src/extensions.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Extensions"><a class="docs-heading-anchor" href="#Extensions">Extensions</a><a id="Extensions-1"></a><a class="docs-heading-anchor-permalink" href="#Extensions" title="Permalink"></a></h1><p>As of <code>v1.9</code> of <code>Julia</code>, packages can provide extension code which is loaded when external packages are loaded.</p><h2 id="Makie"><a class="docs-heading-anchor" href="#Makie">Makie</a><a id="Makie-1"></a><a class="docs-heading-anchor-permalink" href="#Makie" title="Permalink"></a></h2><p>When <code>Makie</code> is loaded, a plot recipe is provided.</p><h2 id="ChainRulesCore"><a class="docs-heading-anchor" href="#ChainRulesCore">ChainRulesCore</a><a id="ChainRulesCore-1"></a><a class="docs-heading-anchor-permalink" href="#ChainRulesCore" title="Permalink"></a></h2><p>When <code>ChainRulesCore</code> is loaded, a <code>frule</code> and <code>rrule</code> is defined for to integrate with different autodifferentiation packages.</p><h2 id="MutableArithmetics"><a class="docs-heading-anchor" href="#MutableArithmetics">MutableArithmetics</a><a id="MutableArithmetics-1"></a><a class="docs-heading-anchor-permalink" href="#MutableArithmetics" title="Permalink"></a></h2><p>When the <code>MutableArithmetics</code> package is loaded, an extension provides its functionality for a few polynomial types, described in the following. Prior to <code>v1.9</code> the external package <code>PolynomialsMutableArithmetics</code> provided the same functionality.</p><p>While polynomials of type <code>Polynomial</code> are mutable objects, operations such as <code>+</code>, <code>-</code>, <code>*</code>, always create new polynomials without modifying its arguments. The time needed for these allocations and copies of the polynomial coefficients may be noticeable in some use cases. This is amplified when the coefficients are for instance <code>BigInt</code> or <code>BigFloat</code> which are mutable themselves. This can be avoided by modifying existing polynomials to contain the result of the operation using the <a href="https://github.com/jump-dev/MutableArithmetics.jl">MutableArithmetics (MA) API</a>.</p><p>Consider for instance the following arrays of polynomials</p><pre><code class="language-julia hljs">using Polynomials
d, m, n = 30, 20, 20
p(d) = Polynomial(big.(1:d))
A = [p(d) for i in 1:m, j in 1:n]
b = [p(d) for i in 1:n]</code></pre><p>In this case, the arrays are mutable objects for which the elements are mutable polynomials which have mutable coefficients (<code>BigInt</code>s). These three nested levels of mutable objects communicate with the MA API in order to reduce allocation. Calling <code>A * b</code> requires approximately 40 MiB due to 2 M allocations as it does not exploit any mutability.</p><pre><code class="language-julia hljs">using MutableArithmetics  # or `using PolynomialsMutableArithmetics` to register `Polynomials` with `MutableArithmetics`

const MA = MutableArithmetics
MA.operate(*, A, b)</code></pre><p>exploits the mutability and hence only allocates approximately 70 KiB due to 4 k allocations.</p><p>If the resulting vector is already allocated, e.g.,</p><pre><code class="language-julia hljs">z(d) = Polynomial([zero(BigInt) for i in 1:d])
c = [z(2d - 1) for i in 1:m]</code></pre><p>then we can exploit its mutability with</p><pre><code class="language-julia hljs">MA.operate!(MA.add_mul, c, A, b)</code></pre><p>to reduce the allocation down to 48 bytes due to 3 allocations.</p><p>These remaining allocations are due to the <code>BigInt</code> buffer used to store the result of intermediate multiplications. This buffer can be preallocated with:</p><pre><code class="language-julia hljs">buffer = MA.buffer_for(MA.add_mul, typeof(c), typeof(A), typeof(b))
MA.buffered_operate!(buffer, MA.add_mul, c, A, b)</code></pre><p>then the second line is allocation-free.</p><p>The <code>MA.@rewrite</code> macro rewrite an expression into an equivalent code that exploit the mutability of the intermediate results. For instance</p><pre><code class="language-julia hljs">MA.@rewrite(A1 * b1 + A2 * b2)</code></pre><p>is rewritten into</p><pre><code class="language-julia hljs">c = MA.operate!(MA.add_mul, MA.Zero(), A1, b1)
MA.operate!(MA.add_mul, c, A2, b2)</code></pre><p>which is equivalent to</p><pre><code class="language-julia hljs">c = MA.operate(*, A1, b1)
MA.mutable_operate!(MA.add_mul, c, A2, b2)</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Note that currently, only the <code>Polynomial</code> and <code>Polynomials.PnPolynomial</code> types implement the API and  only</p></div></div><p>part of it is implemented</p><h2 id="PolyCompat"><a class="docs-heading-anchor" href="#PolyCompat">PolyCompat</a><a id="PolyCompat-1"></a><a class="docs-heading-anchor-permalink" href="#PolyCompat" title="Permalink"></a></h2><p>While not an extension, the older  <code>Poly</code> type that this package used prior to <code>v0.7</code>  is implemented as an alternate basis and provided on an opt-in bases by executing <code>using Polynomials.PolyCompat</code>. This is to provide support for older code bases.</p></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.1.2 on <span class="colophon-date" title="Thursday 9 November 2023 22:49">Thursday 9 November 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
